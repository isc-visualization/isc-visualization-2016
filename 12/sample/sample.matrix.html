<!DOCTYPE html>
<html lang="kr">

<head>
    <meta charset="utf-8">
    <title>D3 페이지 템플릿</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <style>
    .link {
      fill: #aaa;
    }
    </style>
</head>

<body>
</svg>
    <script type="text/javascript">
    var w = 600;
    var margin = {top:20, right:20, bottom: 20, left: 20};
    var innerW = w - margin.right - margin.left;

    var svg = d3.select('body').append('svg')
        .attr('width', w)
        .attr('height', w)
      .append('g')
        .attr('transform', 'translate('+ [margin.left, margin.top] + ')');

    d3.json('miserables.json', callback);
    function callback(err, data) {
      if(err) return console.error(err);
      var c = d3.scaleOrdinal()
        .domain(data.nodes.map(function(d){return d.group;}))
        .range(d3.schemeCategory20);
      var x = d3.scaleBand()
        .domain(data.nodes.map(function(d){return d.id;}))
        .range([0, innerW]);

      var xNode = svg.selectAll('.x.node')
          .data(data.nodes)
        .enter().append('rect')
          .attr('class', 'x node')
          .attr('x', function(d){return x(d.id);})
          .attr('y', function(d){return -x.bandwidth()*2;})
          .attr('width', x.bandwidth())
          .attr('height', x.bandwidth())
          .style('fill', function(d){return c(d.group);})
      var yNode = svg.selectAll('.y.node')
          .data(data.nodes)
        .enter().append('rect')
          .attr('class', 'y node')
          .attr('x', -x.bandwidth()*2)
          .attr('y', function(d){return x(d.id);})
          .attr('width', x.bandwidth())
          .attr('height', x.bandwidth())
          .style('fill', function(d){return c(d.group);})

      var xLink = svg.selectAll('.x.link')
          .data(data.links)
        .enter().append('rect')
          .attr('class', 'x link')
          .attr('x', function(d){return x(d.source);})
          .attr('y', function(d){return x(d.target);})
          .attr('width', x.bandwidth())
          .attr('height', x.bandwidth());

      var yLink = svg.selectAll('.y.link')
          .data(data.links)
        .enter().append('rect')
          .attr('class', 'y link')
          .attr('x', function(d){return x(d.target);})
          .attr('y', function(d){return x(d.source);})
          .attr('width', x.bandwidth())
          .attr('height', x.bandwidth());


    } // end of callaback





    </script>
</body>

</html>
